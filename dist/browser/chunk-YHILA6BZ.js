import{k as K,l as W,m as X}from"./chunk-RF77TZJP.js";import{c as J,d as U,f as w,h as R}from"./chunk-XAZLOLJU.js";import{Ab as l,Cb as s,Gb as $,Hb as Q,Ib as Y,Lb as T,Mb as v,Sa as m,Sb as q,Tb as V,Vb as k,X as b,a as z,b as F,ba as h,bb as A,da as x,hb as S,hc as G,m as f,ma as p,mb as d,na as u,pc as H,qb as C,r as I,sb as j,tb as B,ua as y,ub as a,vb as c,wb as N,xb as _}from"./chunk-STD32FX4.js";var et=["inputValue"],it=i=>({"has-items":i}),nt=i=>({container:i}),ot=i=>({"remove-margin-bottom":i});function rt(i,e){i&1&&(a(0,"h1"),v(1,"Minha lista"),c())}var E=class i{inputValue;inputListItems=[];outputAddListItem=new y;focustAndAddItem(e){if(e){this.inputValue.nativeElement.value="";let t=this.generateId();return this.outputAddListItem.emit({checked:!1,value:e,id:t}),this.inputValue.nativeElement.focus()}}generateId(){return Math.random().toString(36).slice(2)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=x({type:i,selectors:[["app-input-add-item"]],viewQuery:function(t,n){if(t&1&&$(et,5),t&2){let o;Q(o=Y())&&(n.inputValue=o.first)}},inputs:{inputListItems:"inputListItems"},outputs:{outputAddListItem:"outputAddListItem"},standalone:!0,features:[V],decls:7,vars:10,consts:[["inputValue",""],["data-test","to-do-input-add-item-header",3,"ngClass"],["data-test","to-do-input-add-item-body",3,"ngClass"],["for","input-value",1,"input-label-text",3,"ngClass"],["type","text","id","input-value","placeholder","Adicione um novo item","autofocus","","data-testid","to-do-input-add-item-input",3,"keyup.enter"],["title","Adicionar um novo item","data-cy","to-do-input-add-item-button",1,"btn","btn-primary-circle",3,"click"]],template:function(t,n){if(t&1){let o=_();a(0,"header",1),S(1,rt,2,0,"h1"),a(2,"div",2)(3,"label",3)(4,"input",4,0),l("keyup.enter",function(){p(o);let g=T(5);return u(n.focustAndAddItem(g.value))}),c(),a(6,"button",5),l("click",function(){p(o);let g=T(5);return u(n.focustAndAddItem(g.value))}),c()()()()}t&2&&(d("ngClass",k(4,it,n.inputListItems.length)),m(),C(n.inputListItems.length>0?1:-1),m(),d("ngClass",k(6,nt,n.inputListItems.length)),m(),d("ngClass",k(8,ot,!n.inputListItems.length)))},dependencies:[H],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   header[_ngcontent-%COMP%]{margin-bottom:24px}[_nghost-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;margin:18px 0;text-align:center}[_nghost-%COMP%]   header[_ngcontent-%COMP%]   .remove-margin-bottom[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]   header.has-items[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;border-bottom:2px solid var(--black-010)}"]})};var at=(i,e)=>e.id;function st(i,e){if(i&1){let t=_();a(0,"label",2)(1,"input",3,0),l("input",function(){let o=p(t).$implicit,r=T(2),g=s();return u(g.updateItemCheckbox(o.id,o.value,r.checked))}),c(),a(3,"input",4,1),l("blur",function(){let o=p(t).$implicit,r=T(4),g=s();return u(g.updateItemValue(o.id,r.value,o.checked))}),c(),a(5,"button",5),l("click",function(){let o=p(t).$implicit,r=s();return u(r.deleteItemValue(o.id))}),c()()}if(i&2){let t=e.$implicit;d("for",t.id)("@fadeInOut",void 0),m(),d("checked",t.checked),m(2),d("value",t.value)("id",t.id)}}var O=class i{inputListItems=[];outputUpdateItemCheckbox=new y;outputUpdateItemValue=new y;outputUpdateItemDelete=new y;updateItemCheckbox(e,t,n){this.outputUpdateItemCheckbox.emit({id:e,value:t,checked:n})}updateItemValue(e,t,n){this.outputUpdateItemValue.emit({id:e,value:t,checked:n})}deleteItemValue(e){this.outputUpdateItemDelete.emit({id:e})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=x({type:i,selectors:[["app-input-list-item"]],inputs:{inputListItems:"inputListItems"},outputs:{outputUpdateItemCheckbox:"outputUpdateItemCheckbox",outputUpdateItemValue:"outputUpdateItemValue",outputUpdateItemDelete:"outputUpdateItemDelete"},standalone:!0,features:[V],decls:2,vars:0,consts:[["inputCheckbox",""],["inputValue",""],[1,"input-label-text",3,"for"],["type","checkbox","data-testid","to-do-list-item-checkbox",3,"input","checked"],["type","text","placeholder","Adicione um novo item","autofocus","","data-testid","to-do-list-item-input",3,"blur","value","id"],["title","delete este item","data-cy","to-do-list-item-delete",1,"btn","btn-danger-circle",3,"click"]],template:function(t,n){t&1&&j(0,st,6,5,"label",2,at),t&2&&B(n.inputListItems)},data:{animation:[J("fadeInOut",[R(":enter",[w({opacity:0,transform:"translateY(-20px)"}),U("300ms linear",w({opacity:1,transform:"translateY(0)"}))]),R(":leave",[U("300ms ease-in",w({opacity:0,transform:"translateY(20px)"}))])])]}})};var M=class i{path="todos";apiService=h(W);constructor(){}getAll(){try{return this.apiService.getAll(this.path).pipe(I(e=>({status:"success",data:e}))).pipe(this.apiService.returnCatchError("Erro ao carregar as tarefas"))}catch{return f([{status:"error",message:"Erro ao carregar as tarefas"}])}}getById(e){try{return this.apiService.getById(this.path,e).pipe(I(t=>({status:"success",data:t}))).pipe(this.apiService.returnCatchError("Erro ao carregar a tarefa"))}catch{return f([{status:"error",message:"Erro ao carregar a tarefa"}])}}getByStage(e){try{return this.apiService.list(this.path,{attr:"checked",value:e==="pending"?"false":"true"}).pipe(I(t=>({status:"success",data:t}))).pipe(this.apiService.returnCatchError("Erro ao carregar as tarefas"))}catch{return f([{status:"error",message:"Erro ao carregar as tarefas"}])}}save(e){try{return this.apiService.create(this.path,e).pipe(I(()=>({status:"success",message:"Tarefa criada com sucesso"}))).pipe(this.apiService.returnCatchError("Erro ao salvar a tarefa"))}catch{return f([{status:"error",message:"Erro ao salvar a tarefa"}])}}updateStage(e,t){try{return this.apiService.updateByPatch(this.path,e,{checked:t==="completed"}).pipe(I(()=>({status:"success",message:"Tarefa atualizada com sucesso"}))).pipe(this.apiService.returnCatchError("Erro ao atualizar a tarefa"))}catch{return f([{status:"error",message:"Erro ao atualizar a tarefa"}])}}update(e){try{return this.apiService.update(this.path,e.id,e).pipe(I(()=>({status:"success",message:"Tarefa atualizada com sucesso"}))).pipe(this.apiService.returnCatchError("Erro ao atualizar a tarefa"))}catch{return f([{status:"error",message:"Erro ao atualizar a tarefa"}])}}deleteAll(){try{return this.apiService.deleteAll(this.path).pipe(I(()=>({status:"success",message:"Tarefas deletadas com sucesso"}))).pipe(this.apiService.returnCatchError("Erro ao deletar as tarefas"))}catch{return f([{status:"error",message:"Erro ao deletar as tarefas"}])}}deleteById(e){try{return this.apiService.deleteById(this.path,e).pipe(I(()=>({status:"success",message:"Tarefa deletada com sucesso"}))).pipe(this.apiService.returnCatchError("Erro ao deletar a tarefa"))}catch{return f([{status:"error",message:"Erro ao deletar a tarefa"}])}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})};var P=class i{#t=A([]);#e=this.#t.asReadonly();constructor(){}getAll(){return this.#e()}getById(e){return this.#e().find(t=>t.id===e)}getByStage(e){return this.#e().filter(t=>e==="pending"?!t.checked:e==="completed"?t.checked:t)}save(e){this.#t.set([...this.#e(),e])}set(e){this.#t.set(e)}updateStage(e,t){this.#t.update(n=>n.map(o=>o.id===e?F(z({},o),{checked:t==="completed"}):o))}update(e){this.#t.update(t=>t.map(n=>n.id===e.id?e:n))}deleteAll(){this.#t.set([])}deleteById(e){this.#t.update(t=>t.filter(n=>n.id!==e))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{todos=[];completedTodos=[];uncompletedTodos=[];toDoService=h(M);state=h(P);notificationService=h(K);authControllerService=h(X);constructor(){G(()=>{this.initialize()})}initialize(){this.completedTodos=this.state.getByStage("completed"),this.uncompletedTodos=this.state.getByStage("pending"),this.todos=this.state.getAll()}listen(){this.toDoService.getAll().subscribe(e=>{this.state.set(e.data||[])})}addTodo(e){if(!this.isAuthorized("admin")){this.notificationService.error("Voce\u0302 na\u0303o tem permissa\u0303o para adicionar tarefas");return}this.toDoService.save(e).subscribe(t=>{this.notificationService.success(t.message||"Tarefa adicionada com sucesso"),this.state.save(e)},t=>{this.notificationService.error(t.message||"Aconteceu algum erro")})}updateTodo(e){if(!this.isAuthorized("admin")){this.notificationService.error("Voce\u0302 na\u0303o tem permissa\u0303o para atualizar tarefas");return}this.toDoService.update(e).subscribe(t=>{this.notificationService.success(t.message||"Tarefa atualizada com sucesso"),this.state.update(e)},t=>{this.notificationService.error(t.message||"Aconteceu algum erro")})}updateStageTodo(e,t){this.toDoService.updateStage(e,t).subscribe(()=>{this.state.updateStage(e,t)},n=>{this.notificationService.error(n.message||"Aconteceu algum erro")})}removeTodo(e){if(!this.isAuthorized("admin")){this.notificationService.error("Voce\u0302 na\u0303o tem permissa\u0303o para deletar tarefas");return}this.toDoService.deleteById(e).subscribe(t=>{this.notificationService.success(t.message||"Tarefa deletada com sucesso"),this.state.deleteById(e)},t=>{this.notificationService.error(t.message||"Aconteceu algum erro")})}removeAllTodos(){if(!this.isAuthorized("admin")){this.notificationService.error("Voce\u0302 na\u0303o tem permissa\u0303o para deletar tarefas");return}this.toDoService.deleteAll().subscribe(e=>{this.notificationService.success(e.message||"Tarefas deletadas com sucesso"),this.state.deleteAll()},e=>{this.notificationService.error(e.message||"Aconteceu algum erro")})}isAuthorized(e){return this.authControllerService.isAuthorized(e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=b({token:i,factory:i.\u0275fac})};function ct(i,e){if(i&1){let t=_();a(0,"button",4),l("click",function(){p(t);let o=s(2);return u(o.isAddItem.set(!1))}),v(1," Crie uma lista de tarefas "),c()}}function pt(i,e){if(i&1){let t=_();a(0,"app-input-add-item",5),l("outputAddListItem",function(o){p(t);let r=s(2);return u(r.addItem(o))}),c()}if(i&2){let t=s(2);d("inputListItems",t.toDoController.todos)}}function ut(i,e){if(i&1&&(a(0,"div",0),N(1,"img",1),S(2,ct,2,0,"button",2)(3,pt,1,1,"app-input-add-item",3),c()),i&2){let t=s();m(2),C(t.isAddItem()?2:3)}}function lt(i,e){if(i&1){let t=_();a(0,"h3"),v(1,"Pendentes"),c(),a(2,"app-input-list-item",7),l("outputUpdateItemCheckbox",function(o){p(t);let r=s(2);return u(r.updateStageItem(o))})("outputUpdateItemValue",function(o){p(t);let r=s(2);return u(r.updateItem(o))})("outputUpdateItemDelete",function(o){p(t);let r=s(2);return u(r.deleteItem(o.id))}),c()}if(i&2){let t=s(2);m(2),d("inputListItems",t.toDoController.uncompletedTodos)}}function mt(i,e){if(i&1){let t=_();a(0,"h3"),v(1,"Conclu\xEDdas"),c(),a(2,"app-input-list-item",7),l("outputUpdateItemCheckbox",function(o){p(t);let r=s(2);return u(r.updateStageItem(o))})("outputUpdateItemValue",function(o){p(t);let r=s(2);return u(r.updateItem(o))})("outputUpdateItemDelete",function(o){p(t);let r=s(2);return u(r.deleteItem(o.id))}),c()}if(i&2){let t=s(2);m(2),d("inputListItems",t.toDoController.completedTodos)}}function dt(i,e){if(i&1){let t=_();a(0,"app-input-add-item",5),l("outputAddListItem",function(o){p(t);let r=s();return u(r.addItem(o))}),c(),a(1,"main",0),S(2,lt,3,1)(3,mt,3,1),c(),a(4,"footer")(5,"button",6),l("click",function(){p(t);let o=s();return u(o.removeAllItems())}),v(6," Deletar todos os items "),c()()}if(i&2){let t=s();d("inputListItems",t.toDoController.todos),m(2),C(t.toDoController.uncompletedTodos.length?2:-1),m(),C(t.toDoController.completedTodos.length?3:-1)}}var tt=class i{isAddItem=A(!0);toDoController=h(L);ngOnInit(){this.getAllItems()}getAllItems(){return this.toDoController.listen()}addItem(e){e&&this.toDoController.addTodo(e)}removeAllItems(){this.toDoController.removeAllTodos()}updateItem(e){this.toDoController.updateTodo(e)}updateStageItem(e){this.toDoController.updateStageTodo(e.id,e.checked?"completed":"pending")}deleteItem(e){this.toDoController.removeTodo(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=x({type:i,selectors:[["app-to-do"]],standalone:!0,features:[q([L]),V],decls:2,vars:1,consts:[[1,"container"],["src","assets/img/task-list-null.png","alt","sua lista est\xE1 v\xE1zia","loading","eager"],["data-cy","to-do-create-button",1,"btn","btn-primary"],[3,"inputListItems"],["data-cy","to-do-create-button",1,"btn","btn-primary",3,"click"],[3,"outputAddListItem","inputListItems"],["data-cy","to-do-remove-all-items",1,"btn","btn-danger",3,"click"],[3,"outputUpdateItemCheckbox","outputUpdateItemValue","outputUpdateItemDelete","inputListItems"]],template:function(t,n){t&1&&S(0,ut,4,1,"div",0)(1,dt,7,3),t&2&&C(n.toDoController.todos.length?1:0)},dependencies:[E,O],styles:["[_nghost-%COMP%]{height:100vh;width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}[_nghost-%COMP%]   div.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}[_nghost-%COMP%]   div.container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], [_nghost-%COMP%]   div.container[_ngcontent-%COMP%]   app-input-add-item[_ngcontent-%COMP%]{margin-top:30px;width:100%}[_nghost-%COMP%]   main.container[_ngcontent-%COMP%]{height:calc(100vh - 220px);overflow-y:auto}[_nghost-%COMP%]   main.container[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}[_nghost-%COMP%]   main.container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:var(--black-010)}[_nghost-%COMP%]   main.container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--primary);border-radius:5px}[_nghost-%COMP%]   footer[_ngcontent-%COMP%]{height:90px;width:100%;display:flex;justify-content:center;align-items:center;border-top:2px solid var(--black-010)}"]})};export{tt as a};
